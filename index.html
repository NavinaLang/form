<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>Vendor List</title>
    <script src="https://code.jquery.com/jquery-git.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.3.4/jspdf.min.js"></script>
    <script type="text/javascript" src="https://fastcdn.org/FileSaver.js/1.1.20151003/FileSaver.js" ></script>

    <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">

    <style>
        body{
            font-family: Arial;
            align: center;
            font-size: 14px;
            font-weight: bold;

            height:297mm;
            width:210mm;
            /* to centre page on screen*/
            margin-left: auto;
            margin-right: auto;
        }
        textarea{
            width: 100px;
        }

        button, submit {
            background-color: rgb(100, 133, 193);
            border: none;
            color: white;
            padding: 5px 22px;
            text-align: center;
            text-decoration: none;
            display: inline-block;
            font-size: 14px;
        }

        input, textarea, select{
            width: 100%;
            padding: 6px;
            border: 1px solid #ccc;
            border-radius: 2px;
            resize: vertical;
        }

        .error{
            display: none;
            margin-left: 10px;
        }

        .error_show{
            color: red;
            margin-left: 10px;
        }

        .tooltip {
            position: relative;
            display: inline;
        }

        .tooltip .tooltiptext {
            visibility: hidden;
            color: red;
            padding: 5px 0;

            /* Position the tooltip */
            z-index: 1;
            top: -5px;
            left: 105%;
        }

        .tooltip:hover .tooltiptext {
            visibility: visible;
        }
    </style>

</head>
<body>

<div align="center" id="form">

    <div style="text-align: left;" id="form2">

        <div style="width: 100%" class="w3-container">
            <h1 style="float:left; font-size: 36px; color: rgb(100, 133, 193); font-weight: 400; margin-left:15px; margin-top:20px;">Vendor List</h1>
            <img style="float: right; margin-top: 15px" width="25%" height="25%" src="https://sp-de-teams.nttdata-emea.com/CenPur/Vendor Liste/logo.jpg">
        </div>
        <br>
        <div  class="w3-container" style="clear: left;" class="sc-hidden" id="requirementData">
            <div class="w3-container">
                <div style="width: 100%; height: 30px; background: rgb(100, 133, 193); font-size: large; margin-top:0; color:white; font-weight: bold;">
                    <p style="margin-left: 10px"> Requirement Data</p>
                </div><br>
            </div>
            <div class="w3-container">
                <label for="titel">Titel*</label><br>
                <input oninput="remove(this.id)" id="titel" type="text" placeholder="Was soll beschafft werden?" required>
                <span id="titelS" class="error">This field is required</span>
            </div><br>
            <div class="w3-container">
                <label for="descr">Detaillierte Bedarfsbeschreibung*</label><br>

                <div class="tooltip">
                    <textarea oninput="remove(this.id)" id="descr" type="text" placeholder="Inhaltliche Beschreibung des Bedarfes hier eingeben"></textarea>
                    <span style="position: absolute" class="tooltiptext">Beschreibung incl. Angabe aller relevanten Angaben zur Angebotseinholung, z.B. Leistungsbild/Produktbeschreibung, Qualitätsbeschreibung, Menge bzw. Anzahl Personen,etc. Vor Bedarfsdeckung durch externe DL muss durch den FB geprüft werden, ob es möglich ist, den Bedarf durch interne Ressourcen zu decken!
            </span>
                </div>
                <span id="descrS" class="error">This field is required</span>
            </div><br>
            <div class="w3-container">
                <label for="pickDate">Spätester Bestelltermin*</label><br>
                <input onchange="remove(this.id)" id="pickDate" type="text" placeholder="dd.mm.yyyy">
                <span id="pickDateS" class="error">This field is required</span>
            </div><br>
            <div class="w3-container">
                <label for="pickDate">Liefer-/Leistungsdatum*</label><br>
                <input oninput="remove(this.id)" id="llDate" type="text" placeholder="Leistungsdatum angeben, bei Veranstaltungen auch Uhrzeit">
                <span id="llDateS" class="error">This field is required</span>
            </div><br>
            <div class="w3-container">
                <label for="llOrt">Liefer-/Leistungsdatum*</label><br>
                <input oninput="remove(this.id)" id="llOrt" type="text" placeholder="Leistungsort angeben">
                <span id="llOrtS" class="error">This field is required</span>
            </div><br>
            <div class="w3-container">
                <label for="ap">Ansprechpartner NTTD*</label><br>
                <input oninput="remove(this.id)" id="ap" type="text" placeholder="Mailadresse Anforderer">
                <span id="apS" class="error">This field is required</span>
            </div><br>
            <div style="font-weight: normal" class="w3-container">
                <p style="font-weight: bold">Geheimhaltung & Datenschutz</p>
                <input style="width: auto; margin-left: 15px" type="checkbox" onchange="showBox(this.id,'secure2');" id="secure" type="text"> NDA (Geheimhaltungsvereinbarung) notwendig<br>
                <div style="display: none;" id="secure2">
                    <input style="width: auto; margin-left: 15px;" type="checkbox" type="text"> NDA bereits vorhanden<br>
                </div>
                <input style="width: auto; margin-left: 15px" type="checkbox" onchange="showBox(this.id,'secure4')" id="secure3" type="text"> ADV (Datenschutzvereinbarung Auftragsdatenverarbeitung) notwendig<br>
                <div style="display: none;" id="secure4">
                    <input style="width: auto; margin-left: 15px;" type="checkbox" type="text"> ADV bereits vorhanden
                </div>
            </div><br>
            <div class="w3-container">
                <label for="ks">Kostenstelle / Projektnr.*</label><br>
                <input oninput="remove(this.id)" id="ks" type="text" placeholder="KST/Projektnr. angeben">
                <span id="ksS" class="error">This field is required</span>
            </div><br>
            <div class="w3-container">
                <label for="cost">Kostenschätzung*</label><br>
                <input oninput="remove(this.id)" id="cost" type="text" placeholder="in € angeben, Schätzung muss den Rahmen der Anforderungen abdecken">
                <span id="costS" class="error">This field is required</span>
            </div><br>
            <div class="w3-container">
                <label for="budget">Budgetfreigabe*</label><br>

                <div class="tooltip">
                    <input oninput="remove(this.id)" id="budget" type="text" placeholder="Name KST-/Projekt- Verantwortlicher, der das Budget freigegeben hat">
                    <span class="tooltiptext">Der Anforderer ist verantwortlich für die vorherige Budgetfreigabe durch den Kosten-Verantwortlichen. Diese schriftliche Freigabe (Mail, Scan, etc) ist zusammen mit dieser vollständig ausgefüllten Bedarfsanfrage an purchasing@nttdata.com zu senden.</span>
                </div>
                <span id="budgetS" class="error">This field is required</span>
            </div>
        </div>
        <div class="w3-container" id="headlineVD">

            <div style="width: 100%; height: 30px; background: rgb(100, 133, 193); font-size: large; margin-top:0px; color:white; font-weight: bold;">
                <p style="margin-left: 10px"> Vendor Data</p>
            </div>

            <table width="100%" id="vendorTable" style="display: none">

                <tr>
                    <td>Firmenbezeichnung</td>
                    <td><input style="width:215%" type=text" placeholder="Name Lieferant"></td>
                </tr>
                <tr>
                    <td>E-Mail</td>
                    <td><input style="width:215%" type=text" placeholder="Mail Ansprechpartner"></td>
                </tr>
                <tr>
                    <td>Telefon</td>
                    <td><input style="width:215%" type=text" placeholder="Telefonnr."></td>
                </tr>
                <tr>
                    <td>Angebot</td>
                    <td>  <select style="width:215%" id="box">
                        <option style="font-weight: normal" value="" selected disabled hidden>Auswählen</option>
                        <option value="yes">Ja, vorhanden & Datei ist angehängt.</option>
                        <option value="no">Nein, nicht vorhanden.</option>
                    </select></td>
                </tr>
                <tr>
                    <td><br></td>
                    <td><br></td>
                </tr>


            </table>

            <table id="vendorList" width="100%">
            </table>

            <table>
                <tr>
                    <td><button style="padding-right: 20px" id="add" onclick="addFields()">Vendor hinzufügen</button></td>
                    <td><p id="choose">Wähle Verndor</p></td>
                    <td><select style="width: 100%" id="tableIndex">
                        <option value="" selected disabled hidden>Auswählen</option>
                    </select></td>
                    <td><button id="delete" onclick="deleteFields()">Vendor löschen</button></td>
                </tr>
            </table>


        </div>

        <div class="w3-container" id="vendorData" hidden>
            <table style="font-family:calibri; font-size:15px">
                <tr>
                    <td>Firmenbezeichnung</td>
                    <td colspan="2"><input type="text" placeholder="Name Lieferant"></td>
                </tr>
                <tr>
                    <td>Kontakt</td>
                    <td><input type="text" placeholder="E-Mail Ansprechpartner" style="width: 250px"></td>
                    <td><input type="text" placeholder="Telefonnr." style="width: 241px"></td>
                </tr>
                <tr>
                    <td>Angebot</td>
                    <td>
                        <select id="box">
                            <option value="yes">Ja</option>
                            <option value="no">Nein</option>
                        </select>
                    </td>
                </tr>
                <tr>
                    <td><br></td>
                    <td><br></td>
                </tr>
            </table>

        </div>
        <br><br>
        <div class="w3-container" id="ss">

            <div style="width: 100%; height: 30px; background: rgb(100, 133, 193); font-size: large; margin-top:0; color:white; font-weight: bold">
                <p style="margin-left: 10px">Single Source Statement</p>
            </div><br>

            <label for="beg">Begündung Anforderer</label><br>

            <div class="tooltip">
                <textarea id="beg" placeholder="Detaillierte Begründung, warum nicht im Wettbewerb / am Markt beschafft werden kann"></textarea><br>
                <span class="tooltiptext">Auszufüllen, wenn nicht im Wettbewerb beschafft werden soll, also nur 1 Lieferant angegeben wird ( = Single Sourcing). Bei Single Sourcing ist vor Bestellung eine Freigabe des HOI einzuholen. Diese schriftliche Freigabe (Mail, Scan, etc) ist zusammen mit dieser vollständig ausgefüllten Bedarfsanfrage an purchasing@tdata.com zu senden.
        </span>
            </div>

        </div><br>
        <div class="w3-container">
            <button id="submit" onclick="senden()">Formular abschicken</button>
        </div>
        <br><br>

    </div>
</div>


<div id="noprint"></div>


<script>

    window.onload = createTable();

    $( function() {
        $( "#pickDate" ).datepicker();
    } );
    document.getElementById("delete").style.display = "none";


    function createTable(){
        var t = document.getElementById("vendorTable");
        document.getElementById("vendorTable").style.display = "block";
        document.getElementById("choose").style.display = "none";
        document.getElementById("tableIndex").style.display = "none";
        var tr = t.cloneNode(true);
        document.getElementById('vendorList').appendChild(tr);
        document.getElementById("vendorTable").style.display = "none";
        document.getElementById("delete").style.display = "none";

        addSelect();

    }

    function addFields() {

        var t = document.getElementById("vendorTable");
        document.getElementById("vendorTable").style.display = "block";
        document.getElementById("choose").style.display = "block";
        document.getElementById("tableIndex").style.display = "block";
        var tr = t.cloneNode(true);
        document.getElementById("vendorList").appendChild(tr);
        document.getElementById("vendorTable").style.display = "none";

        if(document.getElementById("vendorList").childElementCount >= 2){
            document.getElementById("vendorData").style.display = "none";
            document.getElementById("ss").style.display = "none";
        }

        addSelect();
    }

    function addSelect(){
        var size = document.getElementById("vendorList").childElementCount;

        var opt = document.createElement('option');
        opt.value = size;
        opt.innerHTML = size;

        var x = document.getElementById("tableIndex").appendChild(opt);

        document.getElementById("delete").style.display = "block";
    }

    function deleteSelect(){
        var size = document.getElementById("vendorList").childElementCount;

        var x = document.getElementById("tableIndex");
        x.remove(size+1);

        if(size == 1){
            document.getElementById("vendorData").style.display = "block";
            document.getElementById("tableIndex").style.display = "none";
            document.getElementById("choose").style.display = "none";
            document.getElementById("delete").style.display = "none";
        }
    }

    function deleteFields(){
        if(document.getElementById("tableIndex").value == ""){
            return;
        }

        var x = document.getElementById("tableIndex").value;
        var table = document.getElementById("vendorList");
        table.removeChild(table.childNodes[x]);

        deleteSelect();
    }

    function getID(){
        var d = new Date();
        return d.getTime();
    }

    function showBox(id, next){
        if(document.getElementById(id).checked){
            document.getElementById(next).style.display = "block";
        } else{
            document.getElementById(next).style.display = "none";
        }
    }

    function senden() {

        var required = ["titel", "descr", "pickDate", "llDate", "llOrt", "ap", "ks", "cost", "budget"];
        var errorMessage = ["titelS", "descrS", "pickDateS", "llDateS", "llOrtS", "apS", "ksS", "costS", "budgetS"];
        var counter = 0;

        for(var i = 0; i < required.length; i++){
            if(document.getElementById(required[i]).value == ""){
                document.getElementById(errorMessage[i]).classList.remove("error");
                document.getElementById(errorMessage[i]).classList.add("error_show");
                document.getElementById(required[i]).style.border = "thin solid red";
                counter ++;
            }
        }

        if(counter > 0) return;

        //generate id - date, time for filename

        document.getElementById("add").style.display = "none";
        document.getElementById("submit").style.display = "none";
        document.getElementById("delete").style.display = "none";
        document.getElementById("tableIndex").style.display = "none";
        document.getElementById("choose").style.display = "none";



        /*var doc = new jsPDF();
        var html=$('#form').html();
        alert (html);
        doc.fromHTML(html , 15, 15, {
            'width': 800
        });

        setTimeout(function(){
            doc.save('test');
        },2000);*/

        window.open("https://sp-de-teams.nttdata-emea.com/CenPur/SitePages/Upload.aspx");
        window.print();


    }

    function remove(element){
        var elementS = document.getElementById(element+"S");
        document.getElementById(element).style.borderStyle ="none";
        document.getElementById(element).style.border = "thin solid black";
        elementS.classList.remove("error_show");
        elementS.classList.add("error");
    }

</script>

</body>
</html>
